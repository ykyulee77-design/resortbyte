# 🖼️ 기숙사 사진 업로드 문제 해결 가이드

## 🚨 긴급 해결 방법

### 1단계: Firebase Storage Rules 확인 및 변경

1. **Firebase Console 접속**
   - [Firebase Console](https://console.firebase.google.com/) 접속
   - 프로젝트 선택 (resortbyte)

2. **Storage Rules 변경**
   - 왼쪽 메뉴에서 **"Storage"** 클릭
   - **"Rules"** 탭 클릭
   - 아래 규칙으로 **완전 교체**:

```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /{allPaths=**} {
      allow read, write: if true;
    }
  }
}
```

3. **규칙 저장**
   - **"게시"** 버튼 클릭
   - 변경사항이 즉시 적용됩니다

### 2단계: 브라우저에서 테스트

1. **브라우저 새로고침**
   - F5 키 또는 Ctrl+R

2. **개발자 도구 열기**
   - F12 키 누르기
   - **Console** 탭 클릭

3. **이미지 업로드 테스트**
   - 기숙사 정보 모달 열기
   - 이미지 업로드 버튼 클릭
   - 작은 이미지 파일 선택 (1MB 이하 권장)

4. **콘솔 메시지 확인**
   - 성공 시: "✅ 파일 업로드 성공!" 메시지
   - 실패 시: 오류 코드와 메시지 확인

### 3단계: 오류별 해결 방법

#### 오류: "storage/unauthorized"
- **원인**: Firebase Storage 권한 문제
- **해결**: 위의 완전 개방 규칙 적용

#### 오류: "storage/retry-limit-exceeded"
- **원인**: 네트워크 문제 또는 파일 크기 문제
- **해결**:
  - 파일 크기를 1MB 이하로 줄이기
  - 인터넷 연결 확인
  - 잠시 후 재시도

#### 오류: "storage/bucket-not-found"
- **원인**: Firebase Storage가 활성화되지 않음
- **해결**:
  1. Firebase Console에서 **"Storage"** 클릭
  2. **"시작하기"** 버튼 클릭
  3. 보안 규칙 선택 (테스트 모드)
  4. **"완료"** 클릭

### 4단계: 성공 확인

#### 성공 시 확인 사항
- ✅ 이미지가 Firebase Storage에 업로드됨
- ✅ 다운로드 URL이 생성됨
- ✅ 이미지 미리보기가 표시됨
- ✅ 콘솔에 "업로드 성공" 메시지 표시

#### Firebase Console에서 확인
1. Firebase Console에서 **"Storage"** 클릭
2. **"Files"** 탭 클릭
3. `accommodation-images` 폴더 확인
4. 업로드된 이미지 파일들 확인

### 5단계: 문제가 지속되는 경우

#### 추가 확인 사항
1. **Firebase 프로젝트 설정**
   - API 키 확인
   - 도메인 설정 확인
   - Storage 버킷 이름 확인

2. **네트워크 연결**
   - 인터넷 연결 상태 확인
   - 방화벽 설정 확인
   - 프록시 설정 확인

3. **브라우저 설정**
   - 브라우저 캐시 삭제
   - 쿠키 삭제
   - 다른 브라우저로 테스트

#### 디버깅 정보 수집
- 브라우저 콘솔의 모든 오류 메시지
- 네트워크 탭의 요청/응답
- Firebase Console의 사용량 통계

### 6단계: 보안 규칙 복원 (선택사항)

문제가 해결되면 보안 규칙으로 다시 변경:

```javascript
rules_version = '2';
service firebase.storage {
  match /b/{bucket}/o {
    match /accommodation-images/{userId}/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
```

## 📞 추가 지원

문제가 지속되면 다음 정보를 수집하여 문의:
1. 브라우저 콘솔 오류 메시지
2. Firebase Console 스크린샷
3. 네트워크 탭 요청/응답
4. 사용 중인 브라우저 및 버전 